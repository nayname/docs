---
title: "Local Network Setup"
description: "Advanced guide for manually setting up custom Cosmos EVM local networks with specific configurations"
---

This guide covers manual setup of local Cosmos EVM networks for advanced use cases that require customizations beyond what the provided `./local_node.sh` script offers.

<Info>

</Info>

<Note>
Currently there are some key network initialization steps that differ from standard Cosmos-SDK chains. See the [Appendix](#appendix) section below for specifics.
</Note>

## Quick Setup

For the majority of cases, setup is as simple as running [`./local_node.sh`](https://github.com/cosmos/evm/blob/main/local_node.sh) from the [cosmos/evm repository](https://github.com/cosmos/evm).
The remainder of this page gets is for those who require specific testing or development environments, and requires a deeper understanding of the setup process.

## Manual Network Setup

### Initialize Node Configuration

```bash
# Initialize the node with your custom moniker
evmd init <your-node-name> --chain-id <your-chain-id>

# Set the chain ID in client configuration (REQUIRED)
evmd config set client chain-id <your-chain-id>
evmd config set client keyring-backend test
```

**Example:**
```bash
evmd init mynode --chain-id local-1
evmd config set client chain-id local-1
evmd config set client keyring-backend test
```

### Create Validator Account

```bash
# Add validator account
evmd keys add validator --keyring-backend test

# Optional: Add additional accounts for testing
evmd keys add user1 --keyring-backend test
evmd keys add user2 --keyring-backend test
```

### Configure Genesis

```bash
# Add initial balances to genesis
evmd genesis add-genesis-account validator 10000000000000000000000000atest --keyring-backend test

# Add balances for additional accounts (optional)
evmd genesis add-genesis-account user1 1000000000000000000000000atest --keyring-backend test
evmd genesis add-genesis-account user2 1000000000000000000000000atest --keyring-backend test

# Create validator genesis transaction
evmd genesis gentx validator 1000000000000000000000atest --keyring-backend test

# Collect all genesis transactions
evmd genesis collect-gentxs
```

### Customize Configuration Files

At this point, you can modify the configuration files to suit your needs:

#### Genesis Configuration (`~/.evmd/config/genesis.json`)
- Module parameters (EVM, fee market, etc.)
- Initial token distributions
- Governance parameters
- Consensus parameters

#### Node Configuration (`~/.evmd/config/config.toml`)
- P2P settings
- Consensus timeouts
- Mempool configuration
- RPC settings

#### Application Configuration (`~/.evmd/config/app.toml`)
- API server settings
- gRPC configuration
- State sync parameters
- Pruning settings
- **EVM and JSON-RPC settings** (see [Node Configuration Guide](/docs/documentation/getting-started/node-configuration))

### Enable JSON-RPC (Recommended)

For Ethereum compatibility, enable the JSON-RPC server in `~/.evmd/config/app.toml`:

```toml
[json-rpc]
# Enable the JSON-RPC server
enable = true

# Enable transaction indexer for eth_getLogs support
enable-indexer = true

# Enable common namespaces
api = "eth,net,web3,txpool,debug"
```

### Start Your Custom Network

```bash
# Start the node
evmd start

# Optional: Start with specific log level
evmd start --log_level debug

# Optional: Start in background
evmd start > ~/.evmd/node.log 2>&1 &
```

<Tip>
**Test Your Setup**: Once your local node is running, try out the interactive [JSON-RPC API Reference](/docs/api-reference/ethereum-json-rpc) to explore all available methods.
(*note: some methods are disabled by default -- see the RPC [methods](/docs/api-reference/ethereum-json-rpc) page and the [node configuration](/docs/documentation/getting-started/node-configuration) for complete details.)
</Tip>

## Advanced Configuration Examples

### Multi-Node Setup

For testing with multiple validators:

```bash
# Node 1
evmd init node1 --chain-id local-1 --home ~/.evmd-node1
evmd config set client chain-id local-1 --home ~/.evmd-node1

# Node 2
evmd init node2 --chain-id local-1 --home ~/.evmd-node2
evmd config set client chain-id local-1 --home ~/.evmd-node2

# Configure persistent peers between nodes
# Edit ~/.evmd-node1/config/config.toml and ~/.evmd-node2/config/config.toml
```

### Custom Chain ID and Denom

```bash
# Using custom chain ID and denomination
evmd init mychain --chain-id custom-evm-1
evmd config set client chain-id custom-evm-1

# Add genesis account with custom denom
evmd genesis add-genesis-account validator 1000000000000000000000000acustom --keyring-backend test
evmd genesis gentx validator 100000000000000000000acustom --keyring-backend test
```

### Development Mode Settings

For rapid development and testing:

```toml
# In config.toml
[consensus]
timeout_propose = "1s"
timeout_prevote = "1s"
timeout_precommit = "1s"
timeout_commit = "1s"

# In app.toml
[json-rpc]
enable = true
enable-indexer = true
api = "eth,net,web3,txpool,debug,personal"
gas-cap = 50000000
```

## Appendix

This section covers known issues and temporary workarounds for Cosmos EVM network initialization that differ from standard Cosmos SDK chains.

### Required Chain ID Configuration

<Warning>
**Genesis Transaction Panic Fix**: Manual setup requires setting the chain ID in client configuration before running `gentx` commands to avoid a runtime panic.
</Warning>

**The Issue**: When running `evmd genesis gentx`, you may encounter a panic like:
```
panic: runtime error: invalid memory address or nil pointer dereference
[signal SIGSEGV: segmentation violation code=0x2 addr=0x30 pc=0x104340e24]
```

**Root Cause**: The panic occurs because `GetEVMCoinDecimals()` tries to access uninitialized coin metadata. The EVM app options only initialize when a valid chain ID is present in the client context.

**Workaround**: Always run this command after `evmd init` and before `evmd genesis gentx`:
```bash
evmd config set client chain-id <your-chain-id>
```

**Why local_node.sh works**: The script automatically sets the chain ID in client configuration at [line 174](https://github.com/cosmos/evm/blob/main/local_node.sh#L174).

### Process Management Issues

<Warning>
**Process Cleanup**: Networks started with `local_node.sh` may not stop properly when using Ctrl+C or closing the terminal.
</Warning>

**The Issue**: The `evmd` process may continue running in the background even after attempting to stop it with standard methods.

**Symptoms**:
- Ctrl+C doesn't stop the process
- Closing the terminal leaves `evmd` running
- Port conflicts when trying to restart
- Multiple `evmd` processes consuming resources

**Workaround**: Force kill the process using one of these commands:
```bash
# Kill all evmd processes
pkill -9 evmd

# Alternative: Find and kill specific process
ps aux | grep evmd
kill -9 <process-id>

# Alternative: Kill by port if using default JSON-RPC port
lsof -ti:8545 | xargs kill -9
```

**Prevention**: When using `local_node.sh`, consider running it in a way that makes process management easier:
```bash
# Run in foreground for easier stopping
./local_node.sh -y

# Or run with explicit process tracking
./local_node.sh -y &
LOCAL_NODE_PID=$!
# Later: kill $LOCAL_NODE_PID
```

### Validation Commands

Use these commands to verify your network setup:

```bash
# Check if evmd is running
ps aux | grep evmd

# Check node status
evmd status

# Verify accounts
evmd keys list --keyring-backend test

# Query balances
evmd query bank balances <address>

# Test JSON-RPC connectivity
curl -X POST -H "Content-Type: application/json" \
  --data '{"jsonrpc":"2.0","method":"eth_chainId","params":[],"id":1}' \
  http://localhost:8545

# Check which ports are in use
netstat -an | grep -E "(8545|26656|26657|1317|9090)"
```

<Note>
These issues are known and being addressed in future releases. The workarounds above are temporary solutions to help with current manual setup requirements.
</Note>

## Next Steps

With your custom local network running:

<CardGroup cols={2}>
  <Card title="Node Configuration" href="/docs/documentation/getting-started/node-configuration" icon="settings">
    Detailed reference for all configuration parameters
  </Card>
  <Card title="Development Tools" href="/docs/documentation/getting-started/tooling-and-resources/overview" icon="wrench">
    Foundry, Hardhat, and other development tools
  </Card>
</CardGroup>
